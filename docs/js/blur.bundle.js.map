{"version":3,"sources":["webpack:///webpack/bootstrap bfc33fe98b02310fe9b1","webpack:///./src/blur/blur.ts","webpack:///./src/stage.ts","webpack:///./src/blur/character.ts","webpack:///./src/blur/shadow.ts"],"names":[],"mappings":";AAAA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,uBAAe;AACf;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;;;;;;ACtCA;AACA;AACA;AACA,WAAU,gBAAgB,sCAAsC,iBAAiB,EAAE;AACnF,0BAAyB,uDAAuD;AAChF;AACA;AACA,wBAAuB,sBAAsB;AAC7C;AACA;AACA,EAAC;AACD,+CAA8C,cAAc;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAC;AACD;AACA;AACA;;;;;;;ACxDA;AACA,+CAA8C,cAAc;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAC;AACD;;;;;;;ACnBA;AACA,+CAA8C,cAAc;AAC5D;AACA;AACA;AACA,+BAA8B,UAAU;AACxC,+BAA8B,UAAU;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA8B,UAAU;AACxC,+BAA8B,UAAU;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAuB,yBAAyB;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAC;AACD;;;;;;;ACtKA;AACA,+CAA8C,cAAc;AAC5D;AACA;AACA,+BAA8B,UAAU;AACxC,+BAA8B,UAAU;AACxC;AACA;AACA;AACA;AACA;AACA;AACA,+BAA8B,UAAU;AACxC,+BAA8B,UAAU;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAC;AACD","file":"blur.bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap bfc33fe98b02310fe9b1","\"use strict\";\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar stage_1 = require(\"../stage\");\r\nvar character_1 = require(\"./character\");\r\nvar Blur = (function (_super) {\r\n    __extends(Blur, _super);\r\n    function Blur() {\r\n        var _this = _super.call(this) || this;\r\n        _this.images = {};\r\n        _this.loadAsset();\r\n        return _this;\r\n    }\r\n    Blur.prototype.loadAsset = function () {\r\n        var _this = this;\r\n        var loader = new createjs.LoadQueue(false);\r\n        loader.loadManifest([\r\n            {\r\n                src: \"../img/tori.png\",\r\n                id: \"tori\"\r\n            },\r\n        ]);\r\n        loader.load();\r\n        loader.on('fileload', function (evt) {\r\n            if (evt.item.type == \"image\") {\r\n                _this.images[evt.item.id] = evt.result;\r\n            }\r\n        }, this);\r\n        loader.on('complete', function () {\r\n            _this.setup();\r\n        }, this, true);\r\n    };\r\n    Blur.prototype.setup = function () {\r\n        _super.prototype.setup.call(this);\r\n        this.character = new character_1.default(this.images.tori, 320, 240);\r\n        this.stage.addChild(this.character.getCharacter());\r\n        this.startTick();\r\n    };\r\n    Blur.prototype.update = function () {\r\n        this.character.setTarget(this.stage.mouseX, this.stage.mouseY);\r\n        this.character.update();\r\n        _super.prototype.update.call(this);\r\n    };\r\n    return Blur;\r\n}(stage_1.default));\r\nwindow.onload = function () {\r\n    new Blur();\r\n};\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/blur/blur.ts\n// module id = 0\n// module chunks = 0","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar Stage = (function () {\r\n    function Stage() {\r\n        this.framerate = 60;\r\n    }\r\n    Stage.prototype.setup = function () {\r\n        this.canvas = document.getElementById(\"canvas\");\r\n        this.stage = new createjs.Stage(this.canvas);\r\n    };\r\n    Stage.prototype.startTick = function () {\r\n        createjs.Ticker.framerate = this.framerate;\r\n        createjs.Ticker.on(\"tick\", this.update, this);\r\n    };\r\n    Stage.prototype.update = function () {\r\n        this.stage.update();\r\n    };\r\n    return Stage;\r\n}());\r\nexports.default = Stage;\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/stage.ts\n// module id = 1\n// module chunks = 0 1 3 4 5 6","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar shadow_1 = require(\"./shadow\");\r\nvar Character = (function () {\r\n    function Character(image, setX, setY) {\r\n        if (setX === void 0) { setX = 0; }\r\n        if (setY === void 0) { setY = 0; }\r\n        this.nowDirection = null;\r\n        this.targetX = 0;\r\n        this.targetY = 0;\r\n        this.moving = false;\r\n        this.shadows = [];\r\n        this.shadowInterval = 3;\r\n        this.shadowIntervalCount = 0;\r\n        this.movingCount = 0;\r\n        this.speed = 5;\r\n        this.image = image;\r\n        this.createCharacter(setX, setY);\r\n    }\r\n    Character.prototype.createCharacter = function (setX, setY) {\r\n        if (setX === void 0) { setX = 0; }\r\n        if (setY === void 0) { setY = 0; }\r\n        var data = {};\r\n        data.images = [this.image];\r\n        data.frames = {\r\n            width: 32,\r\n            height: 32,\r\n            regX: 16,\r\n            regY: 32\r\n        };\r\n        data.animations = {\r\n            stand: [0, 2, 'stand', 0.3],\r\n            up: [9, 11, 'up', 0.3],\r\n            down: [6, 8, 'down', 0.3],\r\n            right: [15, 17, 'right', 0.3],\r\n            left: [12, 14, 'left', 0.3],\r\n            damaged: {\r\n                frames: [\r\n                    3, 4, 3, 4\r\n                ],\r\n                speed: 0.3,\r\n                next: 'stand'\r\n            },\r\n        };\r\n        var spriteSheet = new createjs.SpriteSheet(data);\r\n        var character = new createjs.Sprite(spriteSheet, \"stand\");\r\n        character.mouseEnabled = false;\r\n        character.scaleX = character.scaleY = 2;\r\n        var graphics = new createjs.Graphics().beginFill('#FFFFFF').drawRect(0, 0, 64, 64);\r\n        var shape = new createjs.Shape(graphics);\r\n        shape.regX = 32;\r\n        shape.regY = 64;\r\n        shape.alpha = 0.01;\r\n        this.characterShape = shape;\r\n        this.characterSprite = character;\r\n        var container = new createjs.Container();\r\n        container.addChild(character);\r\n        container.addChild(shape);\r\n        container.x = setX;\r\n        container.y = setY;\r\n        this.character = container;\r\n    };\r\n    Character.prototype.getCharacter = function () {\r\n        return this.character;\r\n    };\r\n    Character.prototype.getCharacterShape = function () {\r\n        return this.characterShape;\r\n    };\r\n    Character.prototype.getCharacterSprite = function () {\r\n        return this.characterSprite;\r\n    };\r\n    Character.prototype.setTarget = function (setX, setY) {\r\n        this.targetX = setX;\r\n        this.targetY = setY;\r\n    };\r\n    Character.prototype.update = function () {\r\n        this.move();\r\n        if (this.isMoving()) {\r\n            this.checkShadow();\r\n        }\r\n        this.updateShadow();\r\n    };\r\n    Character.prototype.updateShadow = function () {\r\n        var newArray = [];\r\n        for (var i = 0; i < this.shadows.length; i++) {\r\n            this.shadows[i].update();\r\n            if (this.shadows[i].isAlive()) {\r\n                newArray.push(this.shadows[i]);\r\n            }\r\n            else {\r\n                this.character.parent.removeChild(this.shadows[i].getCharacter());\r\n            }\r\n        }\r\n        this.shadows = newArray;\r\n    };\r\n    Character.prototype.checkShadow = function () {\r\n        var character = this.getCharacter();\r\n        if (++this.shadowIntervalCount > this.shadowInterval) {\r\n            this.shadowIntervalCount = 0;\r\n            this.character.cache(-32, -64, 64, 64);\r\n            var shadow = new shadow_1.default(this.character.cacheCanvas, character.x, character.y);\r\n            this.shadows.push(shadow);\r\n            character.parent.addChild(shadow.getCharacter());\r\n            character.parent.swapChildren(this.getCharacter(), shadow.getCharacter());\r\n            this.character.uncache();\r\n        }\r\n    };\r\n    Character.prototype.move = function () {\r\n        var object = this.getCharacter();\r\n        var targetX = this.targetX;\r\n        var targetY = this.targetY;\r\n        var beforeX = object.x;\r\n        var beforeY = object.y;\r\n        var distance = Math.sqrt((targetX - beforeX) * (targetX - beforeX) + (targetY - beforeY) * (targetY - beforeY));\r\n        this.moving = false;\r\n        if (distance >= 5) {\r\n            this.moving = true;\r\n            object.x += (targetX - beforeX) / distance * (this.speed + (this.movingCount / 3));\r\n            object.y += (targetY - beforeY) / distance * (this.speed + (this.movingCount / 3));\r\n            this.changeDirection(beforeX, beforeY, object.x, object.y);\r\n        }\r\n    };\r\n    Character.prototype.changeDirection = function (beforeX, beforeY, afterX, afterY) {\r\n        var diffX = Math.abs(beforeX - afterX);\r\n        var diffY = Math.abs(beforeY - afterY);\r\n        var setPos = 'stand';\r\n        if (beforeY - afterY < 0) {\r\n            setPos = 'down';\r\n            if (diffX > diffY) {\r\n                if (beforeX - afterX < 0) {\r\n                    // みぎ\r\n                    setPos = 'right';\r\n                }\r\n                else if (beforeX - afterX > 0) {\r\n                    // ひだり\r\n                    setPos = 'left';\r\n                }\r\n            }\r\n        }\r\n        else if (beforeY - afterY > 0) {\r\n            setPos = 'up';\r\n            if (diffX > diffY) {\r\n                if (beforeX - afterX < 0) {\r\n                    // みぎ\r\n                    setPos = 'right';\r\n                }\r\n                else if (beforeX - afterX > 0) {\r\n                    // ひだり\r\n                    setPos = 'left';\r\n                }\r\n            }\r\n        }\r\n        if (this.nowDirection != setPos) {\r\n            this.movingCount = 0;\r\n            this.nowDirection = setPos;\r\n            this.characterSprite.gotoAndPlay(setPos);\r\n        }\r\n        else {\r\n            this.movingCount++;\r\n        }\r\n    };\r\n    Character.prototype.isMoving = function () {\r\n        return this.moving;\r\n    };\r\n    return Character;\r\n}());\r\nexports.default = Character;\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/blur/character.ts\n// module id = 2\n// module chunks = 0","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar Shadow = (function () {\r\n    function Shadow(image, setX, setY) {\r\n        if (setX === void 0) { setX = 0; }\r\n        if (setY === void 0) { setY = 0; }\r\n        this.life = 30;\r\n        this.alive = true;\r\n        this.image = image;\r\n        this.createCharacter(setX, setY);\r\n    }\r\n    Shadow.prototype.createCharacter = function (setX, setY) {\r\n        if (setX === void 0) { setX = 0; }\r\n        if (setY === void 0) { setY = 0; }\r\n        var matrix = new createjs.ColorMatrix();\r\n        matrix.adjustHue(240);\r\n        var bmp = new createjs.Bitmap(this.image);\r\n        bmp.alpha = 0.8;\r\n        var bmp2 = new createjs.Bitmap(this.image);\r\n        bmp2.filters = [\r\n            // new createjs.ColorMatrixFilter(matrix)\r\n            new createjs.ColorFilter(0, 0, 1, 1, 96, 25, 134, 0)\r\n        ];\r\n        bmp2.cache(0, 0, 64, 64);\r\n        var container = new createjs.Container();\r\n        container.addChild(bmp);\r\n        container.addChild(bmp2);\r\n        container.x = setX - 32;\r\n        container.y = setY - 64;\r\n        // container.alpha = 0.7;\r\n        this.character = container;\r\n    };\r\n    Shadow.prototype.getCharacter = function () {\r\n        return this.character;\r\n    };\r\n    Shadow.prototype.update = function () {\r\n        if (--this.life < 0) {\r\n            this.alive = false;\r\n        }\r\n        this.character.alpha -= 0.02;\r\n    };\r\n    Shadow.prototype.isAlive = function () {\r\n        return this.alive;\r\n    };\r\n    return Shadow;\r\n}());\r\nexports.default = Shadow;\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/blur/shadow.ts\n// module id = 3\n// module chunks = 0"],"sourceRoot":""}